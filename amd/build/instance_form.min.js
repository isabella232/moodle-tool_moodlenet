define(["jquery","tool_moodlenet/validator","tool_moodlenet/selectors","core/loadingicon"],function(a,b,c,d){var e=function(a){var b=document.querySelector(c.region.instancePage);f(b,a)},f=function(e,f){e.addEventListener("click",function(g){if(g.target.matches(c.action.browse)&&(window.location=f),g.target.matches(c.action.submit)){var h=e.querySelector('[data-var="mnet-link"]'),i=e.querySelector(c.region.spinner),j=document.querySelector(c.region.validationArea);i.classList.remove("d-none"),e.querySelector(c.action.submit).classList.add("disabled");var k=d.addIconToContainerWithPromise(a(i));b.validation(h).then(function(a){k.resolve(),i.classList.add("d-none"),e.querySelector(c.action.submit).classList.remove("disabled"),a.result?(h.classList.remove("is-invalid"),h.classList.add("is-valid"),j.innerText=a.message,j.classList.remove("text-error"),j.classList.add("text-success"),setTimeout(function(){window.location=a.domain},1e3)):(h.classList.add("is-invalid"),j.innerText=a.message,j.classList.add("text-error"))})["catch"]()}})};return{init:e}});